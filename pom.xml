<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.csstudio</groupId>
  <artifactId>maven-osgi-bundles</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>pom</packaging>
  <name>maven-osgi-bundle</name>
<!-- PROPERTIES -->
  <properties>
    <!-- VERSIONS -->
    <tycho.version>0.19.0</tycho.version>
    <tycho-extras.version>0.19.0</tycho-extras.version>
    <cs-studio.url>http://download.controlsystemstudio.org/updates/3.3</cs-studio.url>
     <pvmanager.version>2.4</pvmanager.version>
     <graphene.version>0.5</graphene.version>
     <pvdata.version>3.0.2</pvdata.version>
     <pvaccess.version>3.0.4</pvaccess.version>
  </properties>
  <repositories>
        <repository>
            <id>epics</id>
            <name>EPICS Repository</name>
            <url>http://epics.sourceforge.net/maven2/</url>
        </repository>
    </repositories>
  <build>
            <plugins>
                <plugin>
                    <groupId>org.reficio</groupId>
                    <artifactId>p2-maven-plugin</artifactId>
                    <version>1.1.1-SNAPSHOT</version>
                    <executions>
                        <execution>
                            <id>default-cli</id>
                            <configuration>
                                <artifacts>
                                    <!-- specify your depencies here -->
                                    <!-- groupId:artifactId:version -->
                                    <artifact>
                                        <id>epics:pvDataJava:${pvdata.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>epics:pvAccessJava:${pvaccess.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-integration:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-exec:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-jdbc:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-timecache:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-pva:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-sample:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-graphene:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-sys:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-extra:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-loc:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-file:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-sim:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-jca:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-vtype:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:epics-vtype:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-test:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:pvmanager-core:${pvmanager.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:graphene-rrdtool:${graphene.version}</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:epics-util:0.2.2</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.epics:epics-vtype:2.1</id>
                                        <source>true</source>
                                    </artifact>
                                    <artifact>
                                        <id>org.hamcrest:hamcrest-library:1.2</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.hamcrest:hamcrest-library:1.3</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.jdom:jdom:1.1</id>
                                    </artifact>
                                    <artifact>
                                        <id>junit:junit-dep:4.10</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.mockito:mockito-core:1.9.5</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.mockito:mockito-core:1.8.5</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.python:jython:2.5.3</id>
                                    </artifact>
                                    <artifact>
                                        <id>org.slf4j:jul-to-slf4j:1.7.2</id>
                                    </artifact>
                                </artifacts>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-antrun-plugin</artifactId>
                    <version>1.7</version>
                    <executions>
                        <execution>
                            <id>copy-metadata-only-to-central-repository</id>
                            <phase>prepare-package</phase>
                            <goals>
                                <goal>run</goal>
                            </goals>
                            <configuration>
                                <failOnError>true</failOnError>
                                <target>
                                    <mkdir dir="${project.build.directory}/centralrepository"/>
                                    <get src="${cs-studio.url}/artifacts.jar"
                                         dest="${project.build.directory}/centralrepository"
                                         verbose="false" ignoreerrors="true" usetimestamp="true"/>
                                    <get src="${cs-studio.url}/content.jar"
                                         dest="${project.build.directory}/centralrepository"
                                         verbose="false" ignoreerrors="true" usetimestamp="true"/>
                                </target>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.eclipse.tycho.extras</groupId>
                    <artifactId>tycho-p2-extras-plugin</artifactId>
                    <version>${tycho.version}</version>
                    <executions>
                      <execution>
                        <id>mirror-build-to-central-repository</id>
                        <phase>package</phase>
                        <goals>
                            <goal>mirror</goal>
                        </goals>
                        <configuration>
                          <!-- Details: https://www.eclipse.org/tycho/sitedocs-extras/tycho-p2-extras-plugin/mirror-mojo.html -->
                          <source>
                              <repository>
                          <url>${project.baseUri}/target/repository</url>
                                  <layout>p2</layout>
                              </repository>
                          </source>
                          <append>true</append>
                          <compress>true</compress>
                          <mirrorMetadataOnly>false</mirrorMetadataOnly>
                          <destination>${project.build.directory}/centralrepository</destination>
                        </configuration>
                      </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.mortbay.jetty</groupId>
                    <artifactId>jetty-maven-plugin</artifactId>
                    <version>8.1.5.v20120716</version>
                    <configuration>
                        <scanIntervalSeconds>10</scanIntervalSeconds>
                        <webAppSourceDirectory>${basedir}/target/repository/</webAppSourceDirectory>
                        <webApp>
                            <contextPath>/site</contextPath>
                        </webApp>
                   </configuration>
                </plugin>
            </plugins>
        </build>

        <pluginRepositories>
            <pluginRepository>
                <id>reficio</id>
                <url>http://repo.reficio.org/maven/</url>
            </pluginRepository>
        </pluginRepositories>
        
</project>
