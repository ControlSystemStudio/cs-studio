<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >

<!-- saved from url=(0041)http://www.desy.de/~kagarman/fft/fft.html -->

<head><title>Discrete Fourier Transform</title>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
	<meta content="MSHTML 6.00.2900.3059" name="GENERATOR" /> 
</head>

<body bgcolor="#ffffff">

<!-- <hr /> -->

<h1>An Introduction to Fourier Theory</h1>
	<p>
		<i>by 
			<a href="mailto:kagarman@mail.desy.de">Albert Kagarmanov</a>, MKS-2 
			<a href="http://www.desy.de/">DESY</a>
		</i> 
	</p>

<!-- obsolete :
<hr />
<p>This paper is available as www.desy.de/~kagarman/fft.html&nbsp; </p>
<hr />
-->

<h3>Introduction</h3>

<p>Linear transforms, especially Fourier and Laplace transforms, are widely used 
in solving problems in science and engineering. The Fourier transform is used in 
linear systems analysis, antenna studies, optics, random process modeling, 
probability theory, quantum physics, and boundary-value problems. The Fourier 
transform, a pervasive and versatile tool, is used in many fields of science as 
a mathematical or physical tool to alter a 
problem into one that can be more 
easily solved. 
</p>

<h3>Theory</h3>

<p><b>Continuous</b></p>
<p>For a continuous function of one variable f(t), the Fourier Transform F(f) 
will be defined as: 
</p>

<p>
<!-- Many img-statements were bracketed by "center". example : -->
<!-- <center><img height="50" src="fft0_files/dft1.gif" width="178" /></center> -->
<!-- in all other occurrences <center> .. </center> : deleted -->
<img height="50" alt="" src="fft0_files/dft1.gif" width="178" />
</p>
<p>and the inverse transform as</p>
<p>
<img height="50" alt="" src="fft0_files/dft2.gif" width="179" />
</p>
<p></p>
<p align="justify">where j is the square root of -1 and e denotes the natural exponent 
</p>
<p>
<img height="25" alt="" src="fft0_files/dft3.gif" width="142" />
</p>
<p><b>Discrete</b></p>
<p>Consider a complex series x(k) with N samples of the form</p>
<p>
<img height="16" alt="" src="fft0_files/dft4.gif" width="170" />
</p>
<p>where x is a complex number</p>
<p>
<img height="17" alt="" src="fft0_files/dft5.gif" width="114" />
</p>
<p></p>
<p align="justify">Further, assume that that the series outside the range 0, N-1 
is extended N-periodic, that is, x<sub>k</sub> = x<sub>k+N</sub> for all k. The 
FT of this series will be denoted X(k), it will also have N samples. The forward 
transform will be defined as </p>
<p>
<img height="54" alt="" src="fft0_files/dft6.gif" width="285" />
</p>
<p>The inverse transform will be defined as</p>
<p>
<img height="53" alt="" src="fft0_files/dft7.gif" width="266" />
</p>
<p></p>
<p align="justify">Of course although the functions here are described as complex 
series, real valued series can be represented by setting the imaginary part to 
0. In general, the transform into the frequency domain will be a complex valued 
function, that is, with magnitude and phase. </p>
<p><img height="54" alt="" src="fft0_files/dft8.gif" width="311" /> </p>
<p align="justify">The following diagrams show the relationship between the series 
index and the frequency domain sample index. </p>
<p>
<img height="76" alt="" src="fft0_files/dft9.gif" width="459" />
</p>
<p></p>
<p align="justify">For example if the series represents a time sequence of length 
T then the following illustrates the values in the frequency domain. </p>
<p>
<img height="140" alt="" src="fft0_files/dft10.gif" width="471" />
</p>

<h3>Notes</h3>

<p>&nbsp;</p>
<ul>
  <li>
  <p align="justify">Max Error for avoid member with i &gt; N&nbsp; 
  is&nbsp;&nbsp;&nbsp;&nbsp; PI/2*MAX(F')*log(N)/N </p></li>
</ul>
<ul>
  <li>
  <p align="justify">The first sample X(0) of the transformed series is the DC 
  component, more commonly known as the average of the input series. </p>
  </li>
  <li>
  <p align="justify">The DFT of a real series, ie: imaginary part of x(k) = 0, 
  results in a symmetric series about the Nyquist ferequency. The negative 
  frequency samples are also the inverse of the positve frequency samples. </p>
  </li>
  <li>
  <p align="justify">The highest positive (or negative) frequency sample is called 
  the Nyquist frequency. This is the highest frequency component that should 
  exist in the input series for the DFT to yield "uncorrupted" results. More 
  specifically if there are no frequencies above Nyquist the original signal can 
  be <b>exactly</b> reconstructed from the samples. </p>
  </li>
  <li>
 <!-- a align="justify" -->  	
  <a>The relationship between the harmonics returns by the 
   DFT and the periodic component in the time domain is illustrated below.Note: 
   We don't show negative frequency here!!!! (so n&lt;=N/2).<br /><br />
   <img height="640" alt="" src="fft0_files/dft0.gif" width="477" /> 
  </a>
  </li>
</ul>
  	
  	
<h3>DFT and FFT algorithm.</h3>

<p align="justify">While the DFT transform above can be applied to any complex 
valued series, in practice for large series it can take considerable time to 
compute, the time taken being proportional to the square of the number on points 
in the series. A much faster algorithm has been developed by Cooley and Tukey 
around 1965 called the FFT (Fast Fourier Transform). The only requirement of the 
the most popular implementation of this algorithm (Radix-2 Cooley-Tukey) is that 
the number of points in the series be a power of 2. The computing time for the 
radix-2 FFT is proportional Nlog(N). S<!-- a align="justify"-->o for example a 
transform on 1024 points using the DFT takes 10 times longer than using the FFT, 
a significant speed increase. Note that in reality comparing speeds of various 
FFT routines is problematic, many of the reported timings have more to do with 
specific coding methods and their relationship to the hardware and operating 
system.<!--/a--> </p>
<!--p align="justify">We defined the FFT as: </p-->
<p>We defined the FFT as: </p>
<!--p align="justify"><a align="justify"><img height="54" alt="equation"    -->
<p><a><img height="54" alt="equation"
src="fft0_files/EQN57.gif" width="271" /></a> </p>
<!-- p align="justify"><a align="justify">If <em>N</em> is even, the above sum can be     -->
<p><a>If <em>N</em> is even, the above sum can be 
split into 'even' (<i>n</i>=2<em>n</em>') and 'odd' (<i>n</i>=2<em>n</em>'+1) 
halves, where <em>n</em>'=0..<em>N</em>/2-1, and re-arranged as follows:</a> 
</p>
<!--p align="justify"><a align="justify"><img height="56" alt="equation"               -->
<p><a><img height="56" alt="equation"
src="fft0_files/EQN59.gif" width="595" /></a> </p>
<!--p align="justify">&nbsp;&nbsp;&nbsp; <img height="56" alt="equation"              -->
<p>&nbsp;&nbsp;&nbsp; <img height="56" alt="equation"
src="fft0_files/EQN58.gif" width="539" /> </p>
<!--p align="justify">&nbsp;&nbsp;&nbsp; <img height="25" alt="equation"             -->
<p>&nbsp;&nbsp;&nbsp; <img height="25" alt="equation"
src="fft0_files/EQN60.gif" width="345" /> </p>
<!--p align="justify">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img height="20"           -->
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img height="20" 
alt="equation" src="fft0_files/EQN61.gif" width="470" /> </p>
<!-- p align="justify">So we have RECURSION, see App. 2 for detailed. </p>               -->
<p>So we have RECURSION, see App. 2 for detailed. </p>
<!-- p align="justify">Nice picture you can find in <a                       -->
<p>Nice picture you can find in <a 
href="http://sepwww.stanford.edu/oldsep/hale/FftLab.html">http://sepwww.stanford.edu/oldsep/hale/FftLab.html</a> 
</p>
<!-- p align="justify"> </p -->
<!-- p align="justify"> </p -->
<p>
</p>

<h3>Sample transform pairs and relationships</h3>
<ul>
  <li>The Fourier transform is linear, that is
  <p>
  <!--center-->
  	a f(t) + b g(t) ---&gt; a F(f) + b G(f)
  <!--/center-->
</p>
  	
  <p>
  <!--center-->
  	a x<sub>k</sub> + b y<sub>k</sub> ---&gt; a X<sub>k</sub> + b Y<sub>k</sub> 
  <!--/center-->
  </p>#
  </li>
</ul>

<!--object-->
<ul>
  <li>Scaling relationship
  <p> <!--center-->f(t / a) ---&gt; a F(a f)<!--/center--> </p>
  <p> <!--center-->f(a t) ---&gt; F(f / a) / a<!--/center--> </p>
  <p></p>
  </li>
  <li>Shifting   <p> <!--center-->f(t + a) ---&gt; F(f) e<sup>-j 2 pi a f</sup> <!--/center--> </p> <p></p> </li> 
  <li>Modulation <p> <!--center-->f(t) e<sup>j 2 pi a t</sup> ---&gt; F(t - a) <!--/center--> </p> <p></p> </li> 
  <li>Duality    <p> <!--center-->X<sub>k</sub> ---&gt; (1/N) x<sub>N-k</sub> <!--/center--></p> </li> 
  <li> <p align="justify">Applying the DFT twice results in a scaled, time reversed 
  	version of the original series. </p> </li>
  <li>The transform of a constant function is a DC value only.<br />
  	<img height="58" alt="" src="fft0_files/dft15.gif" width="296" /> <p></p> </li>
  <li>The transform of a delta function is a constant<br />
  	<img height="58" alt="" src="fft0_files/dft16.gif" width="296" /> <p></p> </li> 
  <li> <p align="justify">The transform of an infinite train of delta functions spaced 
  	by T is an infinite train of delta functions spaced by 1/T. </p> 
	<img height="87" alt="" src="fft0_files/dft23.gif" width="303" /> <p></p> </li> 
  <li> <p align="justify">The transform of a cos function is a positive delta at the 
  	appropriate positive and negative frequency. </p>
	<img height="80" alt="" src="fft0_files/dft17.gif" width="303" /> <p></p> </li>
  <li> <p align="justify">The transform of a sin function is a negative complex delta 
  	function at the appropriate positive frequency and a negative complex delta at 
  	the appropriate negative frequency. </p> 
	<img height="93" alt="" src="fft0_files/dft18.gif" width="303" /> <p></p> </li>
  <li>	<p>The transform of a square pulse is a sinc function </p>
  	<p> <img height="76" alt="" src="fft0_files/dft19.gif" width="302" /> </p>
  	<p></p>
  	<p align="justify">More precisely, if f(t) = 1 for |t| &lt; 0.5, and f(t) = 0 
  	otherwise then F(f) = sin(pi f) / (pi f) </p> </li>
  <li>Convolution
  <p> <!--center-->f(t) <b>x</b> g(t) ---&gt; F(f) G(f) <!--/center--> </p>
  <p>F(f) <b>x</b> G(f) ---&gt; f(t) g(t) </p>
  <p>x<sub>k</sub> <b>x</b> y<sub>k</sub> ---&gt; N X<sub>k</sub> Y<sub>k</sub> </p>
  <p>x<sub>k</sub> y<sub>k</sub> ---&gt; (1/N) X<sub>k</sub> <b>x</b> Y<sub>k</sub> </p>
  <p align="justify">Multiplication in one domain is equivalent to convolution in 
  the other domain and visa versa. For example the transform of a truncated sin 
  function are two delta functions convolved with a sinc function, a truncated 
  sin function is a sin function multiplied by a square pulse. </p>
  </li>
  <li>
  <p align="justify">The transform of a triangular pulse is a sinc<sup>2</sup> 
  function. This can be derived from first principles but is more easily derived 
  by decribing the triangular pulse as the convolution of two square pulses and 
  using the convolution-multiplication relationship of the Fourier Transform. 
  </p>
  </li>
  </ul>
<!--/object-->
  
<p align="justify"> </p>


<h3>FFT-problems:</h3>

<p align="justify">Some expiriments Signal with : 100Hz freq, and we have 2 FFT: 
</p>
<p align="justify">1. Samples are 91,94,...115 (Lucky) </p>
<p align="justify">2) Samples are 90,93,...114 (Unlucky) </p>
<p align="justify"> </p>
<div align="center">
<!--center-->
<!--table class="ms10" bordercolor="#d8d8d8" cellspacing="0" cellpadding="2" border="1"-->
<table class="ms10" cellspacing="0" cellpadding="2" border="1">
  <tbody>
  <tr>
    <th colspan="2">Lucky FFT</th>
    <th colspan="2">Unlucky FFT</th></tr>
  <tr>
    <td align="center">Freq</td>
    <td align="center">Amplit<br /></td>
    <td align="center">Freq</td>
    <td align="center">Amplit.</td></tr>
  <tr>
    <td align="center">91</td>
    <td align="center">0</td>
    <td align="center">90</td>
    <td align="center">0.04</td></tr>
  <tr>
    <td align="center">94</td>
    <td align="center">0</td>
    <td align="center">93</td>
    <td align="center">0.11</td></tr>
  <tr>
    <td align="center">97</td>
    <td align="center">0</td>
    <td align="center">96</td>
    <td align="center">0.14</td></tr>
  <tr>
    <td align="center">100</td>
    <td align="center">1</td>
    <td align="center">99</td>
    <td align="center">0.85</td></tr>
  <tr>
    <td align="center">103</td>
    <td align="center">0</td>
    <td align="center">102</td>
    <td align="center">0.19</td></tr>
  <tr>
    <td align="center">106</td>
    <td align="center">0</td>
    <td align="center">105</td>
    <td align="center">0.15</td></tr>
  <tr>
    <td align="center">109</td>
    <td align="center">0</td>
    <td align="center">108</td>
    <td align="center">0.09</td></tr>
  <tr>
    <td align="center">112</td>
    <td align="center">0</td>
    <td align="center">111</td>
    <td align="center">0.02</td></tr>
  <tr>
    <td align="center">115</td>
    <td align="center">0</td>
    <td align="center">114</td>
    <td align="center">0.001</td></tr>
</tbody></table><!--/center--></div>

<p>&nbsp;</p>
<p>One way to do this is to multiply the signal by a 'window' function:</p>
<p><img height="173" alt="" src="fft0_files/3_window.gif" width="512" />&nbsp;</p>
<p>Most popular window function is&nbsp; Welch -- Bartlett -- Hanning/Hamming -- 
Kaiser</p>
<p><img height="410" alt="" src="fft0_files/hanning1.gif" width="600" /></p>
<div align="center">
<!--table class="ms10" bordercolor="#d8d8d8" cellspacing="0" cellpadding="2" border="1"-->
<table class="ms10" cellspacing="0" cellpadding="2" border="1">
  <tbody>
  <tr>
    <th colspan="2">Unlucky FFT</th>
    <th colspan="2">Unlucku FFT �mming</th></tr>
  <tr>
    <td align="center">Freq</td>
    <td align="center">Ampl.<br /></td>
    <td align="center">Freq</td>
    <td align="center">Ampl.<br /></td></tr>
  <tr>
    <td align="center">91</td>
    <td align="center">0.04</td>
    <td align="center">91</td>
    <td align="center">0.0011</td></tr>
  <tr>
    <td align="center">93</td>
    <td align="center">0.11</td>
    <td align="center">93</td>
    <td align="center">0.013</td></tr>
  <tr>
    <td align="center">96</td>
    <td align="center">0.14</td>
    <td align="center">96</td>
    <td align="center">0.021</td></tr>
  <tr>
    <td align="center">99</td>
    <td align="center">0.85</td>
    <td align="center">99</td>
    <td align="center">0.97</td></tr>
  <tr>
    <td align="center">102</td>
    <td align="center">0.19</td>
    <td align="center">102</td>
    <td align="center">0.04</td></tr>
  <tr>
    <td align="center">105</td>
    <td align="center">0.15</td>
    <td align="center">105</td>
    <td align="center">0.011</td></tr>
  <tr>
    <td align="center">108</td>
    <td align="center">0.09</td>
    <td align="center">108</td>
    <td align="center">0.003</td></tr>
  <tr>
    <td align="center">111</td>
    <td align="center">0.02</td>
    <td align="center">111</td>
    <td align="center">0.0015</td></tr>
  <tr>
    <td align="center">114</td>
    <td align="center">0.001</td>
    <td align="center">114</td>
    <td align="center">0.0001</td></tr></tbody></table></div>
<p>&nbsp;&nbsp;</p>
<h3>Sampling theorem</h3>
<p align="justify">The sampling theorem (often called "Shannons-Kotelnikov 
Sampling Theorem") states that a continuous signal must be discretely sampled at 
least twice the frequency of the highest frequency in the signal. </p>
<p align="justify">More precisely, a continuous function f(t) is completely 
defined by samples every 1/fs (fs is the sample frequency) if the frequency 
spectrum F(f) is zero for f &gt; fs/2. fs/2 is called the Nyquist frequency and 
places the limit on the minimum sampling frequency when digitising a continuous 
signal. </p>
<p align="justify">If x(k) are the samples of f(t) every 1/fs then f(t) can be 
<b>exactly</b> reconstructed from these samples, if the sampling theorem has 
been satisfied, by </p>
<p><!--center--><img height="49" alt="" src="fft0_files/dft12.gif" width="205" /><!--/center--></p>
<p>where </p>
<p> <!--center--><img height="35" alt="" src="fft0_files/dft13.gif" width="120" /><!--/center--> </p>
<p align="justify">Normally the signal to be digitised would be appropriately 
filtered before sampling to remove higher frequency components. If the sampling 
frequency is not high enough the high frequency components will wrap around and 
appear in other locations in the discrete spectrum, thus corrupting it. </p>
<p align="justify">The key features and consequences of sampling a continuous 
signal can be shown graphically as follows. </p>
<p>Consider a continuous signal in the time and frequency domain. </p>
<p> <!--center--><img height="124" alt="" src="fft0_files/dft20.gif" width="520" /><!--/center--></p>
<p align="justify">Sample this signal with a sampling frequency f<sub>s</sub>, 
time between samples is 1/f<sub>s</sub>. This is equivalent to convolving in the 
frequency domain by f<sub>s</sub>. </p>
<p> <!--center--><img height="137" alt="" src="fft0_files/dft21.gif" width="520" /><!--/center--> </p>
<p> </p>
<p align="justify">If the sampling frequency is too low the frequency spectrum
	overlaps, the high frequency components are added into the low frequency range. </p>
<p> <!--center--><img height="132" alt="" src="fft0_files/dft22.gif" width="523" /><!--/center--> </p>

<hr />

<h3>Conclusion:</h3>

<ul>
  <li> <p align="justify">1 FT provide (T,X) &lt;-&gt; (f,A) mapping! </p> </li>
  <li> <p align="justify">FFT is NOT "Some other" DFT it's absolutely the same DFT but calculates VERY faster. </p> </li>
  <li> <p align="justify">FFT do NOT calculate frequency of function! It calculate some 
	"own" frequency , which can be closed with frequency of function. </p> </li>
  <li> <p align="justify">ONLY one&nbsp; is absolutely true InverseFFT*FFT = 1, It's 
	useful for signal storage/compression, MP3, jpeg .... </p> </li>
  <li> <p align="justify">We can't calculate frequency &gt; 2/N using FFT </p> </li>
  <!-- li> <p align="justify"><a align="justify">For avoid unlucky sampling we need to use                 -->
  <li> <p><a>For avoid unlucky sampling we need to use
	window function. </a> </p> </li>
  <li> <p align="justify">There a lot of FFT with n != 2**P, but it is more slow than 
	radix-2 fft. If n&lt;2**p we can increase this n to 2**p adding 0.0 in tail of 
	sampling.&nbsp; </p> </li>
  <!-- li> <p align="justify"><a align="justify">&nbsp; Theorem of Shennon-Kotelnikov is                     -->
  <li> <p><a>&nbsp; Theorem of Shennon-Kotelnikov is
	"corner stone" of all information theory, and is analog of Heisenberg Theorem
	in quantum theory. </a> </p> </li>
  <!-- li> <p align="justify"> <a align="justify"> </a> </p> </li-->
  <li> <p> <a> </a> </p> </li>
</ul>
	
<h3>Appendix A. DFT (Discrete Fourier Transform)</h3>

<pre>
/*
   Direct fourier transform
*/
short DFT(dir,m,x1,y1,x2,y2)
short dir;
long m;
double *x1,*y1;
double *x2,*y2;
{
   long i,k;
   double arg;
   double cosarg,sinarg;
   
   for (i=0;i&lt;m;i++) {
      x2[i] = 0;
      y2[i] = 0;
      arg = - dir * 2.0 * PI * i / (double)m;
      for (k=0;k&lt;m;k++) {
         cosarg = cos(k * arg);
         sinarg = sin(k * arg);
         x2[i] += (x1[k] * cosarg - y1[k] * sinarg);
         y2[i] += (x1[k] * sinarg + y1[k] * cosarg);
      }
   }
   
   /* Copy the data back */
   if (dir == 1) {
      for (i=0;i&lt;m;i++) {
         x1[i] = x2[i] / m;
         y1[i] = y2[i] / m;
      }
   } else {
      for (i=0;i&lt;m;i++) {
         x1[i] = x2[i];
         y1[i] = y2[i];
      }
   }
   
   return(TRUE);
}</pre>
<hr />

<h3>Appendix B. FFT (Fast Fourier Transform)</h3>

<pre>
/*
   This computes an in-place complex-to-complex FFT 
   x and y are the real and imaginary arrays of 2^m points.
   dir =  1 gives forward transform
   dir = -1 gives reverse transform 
*/
short FFT(dir,m,x,y)
short dir;
long m;
double *x,*y;
{
   long n,i,i1,j,k,i2,l,l1,l2;
   double c1,c2,tx,ty,t1,t2,u1,u2,z;

   /* Calculate the number of points */
   n = 1;
   for (i=0;i&lt;m;i++) 
      n *= 2;

   /* Do the bit reversal */
   i2 = n &gt;&gt; 1;
   j = 0;
   for (i=0;i&lt;n-1;i++) {
      if (i &lt; j) {
         tx = x[i];
         ty = y[i];
         x[i] = x[j];
         y[i] = y[j];
         x[j] = tx;
         y[j] = ty;
      }
      k = i2;
      while (k &lt;= j) {
         j -= k;
         k &gt;&gt;= 1;
      }
      j += k;
   }

   /* Compute the FFT */
   c1 = -1.0; 
   c2 = 0.0;
   l2 = 1;
   for (l=0;l&lt;m;l++) {
      l1 = l2;
      l2 &lt;&lt;= 1;
      u1 = 1.0; 
      u2 = 0.0;
      for (j=0;j&lt;l1;j++) {
         for (i=j;i&lt;n;i+=l2) {
            i1 = i + l1;
            t1 = u1 * x[i1] - u2 * y[i1];
            t2 = u1 * y[i1] + u2 * x[i1];
            x[i1] = x[i] - t1; 
            y[i1] = y[i] - t2;
            x[i] += t1;
            y[i] += t2;
         }
         z =  u1 * c1 - u2 * c2;
         u2 = u1 * c2 + u2 * c1;
         u1 = z;
      }
      c2 = sqrt((1.0 - c1) / 2.0);
      if (dir == 1) 
         c2 = -c2;
      c1 = sqrt((1.0 + c1) / 2.0);
   }

   /* Scaling for forward transform */
   if (dir == 1) {
      for (i=0;i&lt;n;i++) {
         x[i] /= n;
         y[i] /= n;
      }
   }
   
   return(TRUE);
}
</pre>

<!--hr /-->

<h3>References</h3>
<p> <b>Fast Fourier Transforms</b><br />Walker, J.S.<br />CRC Press. 1996 </p> 
<p> <b>Fast Fourier Transforms: Algorithms<br /></b>Elliot, D.F. and Rao, K.R.<br />Academic Press, New York, 1982 </p>
<p> <b>Fast Fourier Transforms and Convolution Algorithms</b><br />Nussbaumer, H.J.<br />Springer, New York, 1982 </p>
<p> <b>Digital Signal Processing</b><br />Oppenheimer, A.V. and Shaffer, R.W.<br />Prentice-Hall, Englewood Cliffs, NJ, 1975 </p>
<p> </p>

</body>
</html>
