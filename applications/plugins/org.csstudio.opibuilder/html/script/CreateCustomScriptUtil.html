<html>
<head>    
    <link rel="stylesheet" href="../default.css" type="text/css" />
    <link rel="stylesheet" href="../../../PRODUCT_PLUGIN/book.css" type="text/css"></link>
    <title>
      Creating Custom ScriptUtil
    </title>
</head>
<body>

<h2>Creating Custom ScriptUtil</h2>
<h3>1. Introduction</h3>
<p>
In case of the existing ScriptUtil APIs cannot meet your requirement, you can create your own ScriptUtil
from Java in Eclipse by yourself, and then call your custom ScriptUtil from BOY script.
The code of this example is availabe in BOY Examples->Miscellaneous->CustomScriptUtil.
</p>

<h3>2. A Step-by-Step Example</h3>
<p>This example will create a simple ScriptUtil that popup a "Hello World!" dialog.</p>

<h4>2.1 Pre-requirements</h4>
<p>The widget plugin will need to have BOY plugin (org.csstudio.opibuilder) as dependecy, 
so you need to have BOY plugin and its dependent CSS plugins installed in your 
Eclipse environment. You can simply copy BOY plugin and its dependencies from
your CSS plugin folder to your Eclipse <code>dropin</code> folder. If you are a CSS developer, you just need to
import these plugins into your workspace from your Mercurial repository.</p>

<h4>2.2 Creating a new Fragment</h4>
<p>Create a new fragment project with all the default settings. 
Use plugin <code>org.csstudio.opibuilder</code> as host.</p>

<h4>2.3 Creating your custom Script Util class</h4>
<p>
In Fragment src folder, creat a package, for example "org.csstudio.opibuilder.customScriptUtilExample".
Go to MATNIFEST.MF->Runtime page, export this package.
In this package create a Class and static methods which you will call in BOY script. 
For example:
<pre class = "example_code">
public class MyScriptUtil {
	
	public static void helloWorld(){
		ConsoleUtil.writeInfo("Hello World!");
		MessageDialog.openInformation(Display.getCurrent().getActiveShell(), "Hello", 
				"MyScriptUtil says: Hello World!");
	}

}
</pre>

</p>

<h4>2.4 Integrate your ScriptUtil into CSS</h4>
<p>
If you are a CSS developer, now your have finished the fragment project. 
You can integrate it into CSS by including this fragment into your CSS build.

Here we will discuss how to add this fragment to an existing CSS.

Open the MANIFEST.MF file and go to the overview tab. Click Export Wizard.
Change the Destination Directory to the any directory you want. 
Leave other settings as default and click Finish. 
When exporting finished, go to the directory you set and copy the .jar file 
to CSS <code>dropins</code> folder.
</p>

<h3>3. Call your Custom ScriptUtil from BOY script</h3>
<p>Here is the JavaScript example. You can also call it from Python Script.
<pre class = "example_code">
importPackage(Packages.org.csstudio.opibuilder.customScriptUtilExample);

MyScriptUtil.helloWorld();
</pre>
</p>


</body>

</html>
